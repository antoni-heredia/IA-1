<?xml version="1.0" encoding="UTF-8"?>
<aiml version="2.0">
<!--Escoge una fruta aleatoria-->
  <category>
    <pattern>iniciar eleccion de fruta</pattern>
    <template>
      <condition name = "frutaelegida">
        <li value = "unknown">
           <think>
             <!--Escoge una fruta aleatoria-->
             <set var = "lista_frutas"> <readset>frutas</readset> </set>
             <set name = "frutas"> <get var = "lista_frutas" /> </set>
             <set var = "cantidad"><srai>COUNT <get name = "frutas"/></srai></set>
             <set var = "posicion"><srai>RANDOM <get var = "cantidad"/></srai></set>
             <set name = "frutaelegida" >
              <srai>
                 SELECTITEM <get var = "posicion"/> IN <get name = "frutas"/>
              </srai>
             </set>

             <set name = "caracteristicasfruta">
               <srai>
                cargar map de la fruta <get name = "frutaelegida" />
               </srai>
             </set>
          </think>

        </li>
        <li>

       </li>
      </condition>
    </template>
  </category>

  <category>
    <pattern>mostrar fruta elegida</pattern>
    <template>
      <get name = "frutaelegida" />
    </template>
  </category>
  <category>
    <pattern>mostrar caracteristicas fruta elegida</pattern>
    <template>
      <get name = "caracteristicasfruta"/>
    </template>
  </category>

<!--Se usa para ver si la fruta elegida por el bot tiene una determinada caracteristica-->
  <category>
    <pattern>caracteristica fruta elegida *</pattern>
    <template>
      <!--Se mira si corresponde con la fruta que fue elegida por el bot-->
      <think>
        <set var = "pos">
          <srai>FINDITEM <star/> IN <get name = "frutaelegida"/></srai>
        </set>
      </think>
        <condition var = "pos">
          <li value="0">
            <!--Si no lo es se pasa a mirar si es una de sus caracteristicas-->
            <think>
              <set var = "pos">
                <srai>FINDITEM <star/> IN <get name = "caracteristicasfruta"/></srai>
              </set>
            </think>

            <condition var = "pos">
              <li value="0">
                no
              </li>
              <li>
                si
              </li>
            </condition>
          </li>
          <li>
            si, acerto la fruta
          </li>
        </condition>

    </template>
  </category>
<!-- se encarga de la ayuda y se le pasa la fruta y la caracteristica-->
  <category>
    <pattern>fruta * caracteristica *</pattern>
    <template>
      <think>
        <set var = "caracteristicasfruta">
          <srai>cargar map de la fruta <star/></srai>
        </set>
      </think>
      <condition var = "caracteristicasfruta">
        <li value="no">
          no
        </li>
        <li>
           <!--Si no lo es se pasa a mirar si es una de sus caracteristicas-->
         <think>
           <set var = "pos">
             <srai>FINDITEM <star index = "2"/> IN <get var = "caracteristicasfruta"/></srai>
           </set>
         </think>
         <condition var = "pos">
           <li value="0">
             no
           </li>
           <li>
             si
           </li>
         </condition>

        </li>
      </condition>
    </template>
  </category>
  <!--Pregunta sobre la caracteristica de la fruta-->
  <category>
    <pattern>la fruta es *</pattern>
    <template>
      <srai>caracteristica fruta elegida <star/></srai>
    </template>
  </category>

  <category>
    <pattern>cargar map de la fruta *</pattern>
    <template>
      <set var = "caracteristicas">
        <map><name>frutas</name><star/></map>
      </set>
    </template>
  </category>

  <category>
    <pattern>map fruta *</pattern>
    <template>
      <set var = "corqueta">
        <srai>cargar map de la fruta <star/></srai>
      </set>
      <condition var = "croqueta">
        <li value = "unknow">
          fallos
        </li>
        <li>dentro</li>
      </condition>
      <get var = "croqueta"/>

    </template>
  </category>

  <category>
    <pattern>es *</pattern>
    <template>
      <srai>caracteristica fruta elegida <star/></srai>
    </template>
  </category>

  <category>
    <pattern>^ tiene vitamina *</pattern>
    <template>
      <srai>caracteristica fruta elegida <star/></srai>
    </template>
  </category>

  <category>
    <pattern>el * es *</pattern>
    <template>
      <srai>fruta <star/> caracteristica <star index = "2"/></srai>
    </template>
  </category>

  <category>
    <pattern>es [el la] *</pattern>
    <template>
      <srai>caracteristica fruta elegida <star/></srai>
    </template>
  </category>

<!--Nivel tres-->
<category>
  <pattern>adivinar fruta</pattern>
  <template>
    <think>
      <!--Se cargan las frutas para despues ir eleminando las descartadas en un set-->
      <set var = "lista_frutas"> <readset>frutas</readset> </set>
      <set name = "frutas_no_descartadas"> <get var = "lista_frutas" /> </set>
    </think>
    <srai>elegir pregunta</srai>
  </template>
</category>

<category>
  <pattern>elegir pregunta</pattern>
  <template>
    <think>
      <set var = "numfrutas">
        <srai>COUNT <get name = "frutas_no_descartadas"/></srai>
      </set>
    </think>

    <condition var = "numfrutas">
      <li value = "1">adivinar fruta</li>
      <li>
        <think>
        <set var = "fruta1" >
         <srai>
            SELECTITEM 1 IN <get name = "frutas_no_descartadas"/>
         </srai>
        </set>
        <set var = "fruta2" >
         <srai>
            SELECTITEM 2 IN <get name = "frutas_no_descartadas"/>
         </srai>
        </set>

        <set var = "map1">
          <srai>
           cargar map de la fruta <get var = "fruta1" />
          </srai>
        </set>

        <set var = "map2">
          <srai>
           cargar map de la fruta <get var = "fruta2" />
          </srai>
        </set>

        <set var = "contador1">1</set>
        <set var = "contador2">1</set>
        <set var="salida1">
          <!--ponemos en la variable salida el tama単o de la lista + 1 que sera cuando pare el bucle-->
          <map name="successor"><srai>COUNT <get var = "map1"/></srai></map>
        </set>
        <set var="salida2">
          <!--ponemos en la variable salida el tama単o de la lista + 1 que sera cuando pare el bucle-->
          <map name="successor"><srai>COUNT <get var = "map2"/></srai></map>
        </set>
      </think>
        <condition var="contador1">
          <li><value><get var="salida1"/></value></li>
          <li value = "no">
            多es <get var = "valor"/>?
          </li>
          <li>
            <think>
              <set var = "valor">
                <srai>
                   SELECTITEM <get var = "contador1"/> IN <get var = "map1"/>
                </srai>
              </set>
              <set var="contador1">
                <map name="successor"><get var="contador1"/></map>
              </set>
              <set var = "valida">
                <srai>fruta <get var = "fruta2"/> caracteristica <get var = "valor"/> </srai>
              </set>
            </think>
            <condition var = "valida">
              <li value = "no">
                <think>
                  <set var = "contador1">no</set>
                </think>
              </li>
              <li></li>
            </condition>
            <loop/>
          </li>
        </condition>

        <condition var = "contador1">
          <li value = "no">
            <think>
              <set var = "contador1">no</set>
            </think>
          </li>
          <li>

            <condition var="contador2">
              <li><value><get var="salida2"/></value></li>
              <li value = "no">
                多es <get var = "valor"/>?
              </li>
              <li>
                <think>
                  <set var = "valor">
                    <srai>
                       SELECTITEM <get var = "contador1"/> IN <get var = "map2"/>
                    </srai>
                  </set>
                  <set var="contador2">
                    <map name="successor"><get var="contador2"/></map>
                  </set>
                  <set var = "valida">
                    <srai>fruta <get var = "fruta1"/> caracteristica <get var = "valor"/> </srai>
                  </set>
                </think>
                <condition var = "valida">
                  <li value = "no">
                    <think>
                      <set var = "contador2">no</set>
                    </think>
                  </li>
                  <li></li>
                </condition>
                <loop/>
              </li>
            </condition>

          </li>
        </condition>
      </li>
    </condition>
    <think>
      <set name = "valoranterior">
        <get var = "valor"/>
      </set>
    </think>
  </template>
</category>



</aiml>
